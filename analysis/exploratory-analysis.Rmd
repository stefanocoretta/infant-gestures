---
title: "Infant gestures"
author: "Stefano Coretta"
date: "17/07/2018"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = normalizePath("../"))
library(tidyverse)
theme_set(theme_minimal())
library(fitdistrplus)
```

# Read data

```{r read, message=FALSE}
gestures <- read_csv("./data/gestures.csv")

gestures_tot <- gestures %>%
  group_by(dyad, background, months, gesture) %>%
  summarise(
    count = sum(count),
    ct = sum(ct)
  ) %>%
  ungroup() %>%
  mutate(
    gesture = factor(gesture, levels = c("reach", "point", "ho_gv"))
  ) %>%
  mutate_if(is.character, as.factor)

utterances <- read_csv("./data/utterances.csv")

utterances_tot <- utterances %>%
  group_by(dyad, background, months) %>%
  summarise(
    utterances = sum(utterances)
  ) %>%
  ungroup()

utterances_compl <- utterances %>% na.omit()
utterances_tcompl <- utterances_tot %>% na.omit()
```

# Summaries

Number of dyads per background.

```{r n-dyads}
gestures %>% group_by(background) %>% summarise(n = n_distinct(dyad))
```

```{r n-dyads}
utterances %>% group_by(background) %>% summarise(n = n_distinct(dyad))
```

15 Bangladeshi, 15 Chinese, 14 English.

Utterances has 7 missing values.

# Plot data

## Gestures

```{r density}
gestures_tot %>%
  ggplot(aes(count)) +
  geom_density() +
  geom_rug() +
  geom_vline(xintercept = median(gestures_tot$count), linetype = "dashed", colour = "orange") +
  geom_vline(xintercept = mean(gestures_tot$count), linetype = "dotted", colour = "blue")
```

```{r density-31}
gestures_tot %>%
  filter(count < 31) %>%
  ggplot(aes(count)) +
  geom_density() +
  geom_rug() +
  geom_vline(xintercept = median(gestures_tot$count), linetype = "dashed", colour = "orange") +
  geom_vline(xintercept = mean(gestures_tot$count), linetype = "dotted", colour = "blue")
```

```{r descdist}
descdist(gestures_tot$count, discrete = TRUE)
```

```{r pois-plot}
plot(fitdist(gestures_tot$count, "pois"))
```

```{r nbinom-plot}
plot(fitdist(gestures_tot$count, "nbinom"))
```

```{r density-months-gest}
gestures_tot %>%
  ggplot(aes(count, fill = as.factor(months))) +
  geom_density(alpha = 0.5) +
  facet_grid(~ gesture)
```

## Utterances

```{r utter-density}
utterances %>%
  ggplot(aes(utterances)) +
  geom_density() +
  geom_rug()
```

```{r utter-tot-density}
utterances_tot %>%
  ggplot(aes(utterances)) +
  geom_density() +
  geom_rug()
```

```{r utter-tot-distr}
descdist(utterances_tcompl$utterances, discrete = TRUE)
```


```{r norm-plot}
plot(fitdist(utterances_tcompl$utterances, "norm"))
```

```{r utter-background}
utterances_tot %>%
  ggplot(aes(utterances, fill = background)) +
  geom_density(alpha = 0.5, colour = NA) +
  geom_rug()
```

```{r utter-months}
utterances_tot %>%
  ggplot(aes(utterances, fill = as.factor(months))) +
  geom_density(alpha = 0.5, colour = NA) +
  geom_rug()
```

```{r utter-months-jitter}
utterances_tot %>%
  ggplot(aes(as.factor(months), utterances)) +
  geom_jitter(width = 0.1)
```

```{r utter-months-jitter}
utterances %>%
  ggplot(aes(as.factor(months), utterances, colour = task)) +
  geom_jitter(width = 0.1) +
  facet_grid(~ task)
```

```{r utter-months-background-jitter}
utterances %>%
  ggplot(aes(as.factor(months), utterances, colour = task)) +
  geom_jitter(width = 0.1) +
  facet_grid(background ~ task)
```

```{r utter-months-background-jitter}
utterances %>%
  ggplot(aes(as.factor(months), utterances, colour = task, group = dyad)) +
  geom_point() +
  geom_line() +
  facet_grid(background ~ task)
```

```{r utter-months-background-jitter-2}
utterances %>%
  ggplot(aes(as.factor(months), utterances, colour = background)) +
  geom_jitter(width = 0.1) +
  facet_grid(background ~ .)
```

```{r utter-background-jitter}
utterances %>%
  ggplot(aes(background, utterances, colour = background)) +
  geom_jitter(width = 0.2) +
  stat_summary(fun.y = median, geom = "point", shape = 18, size = 6, color = "black")
```
